{
    "componentChunkName": "component---src-templates-post-template-tsx",
    "path": "/RxJS/from_and_defer/",
    "result": {"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<h1>RxJS의 from()과 defer()</h1>\n<p>프로젝트를 진행하면서, 외부 API를 호출할 때 RxJS 라이브러리의 defer() 함수와 from() 함수의 동작 방식이 다르다는 것을 알게 되었습니다. 이에 두 함수의 차이점을 직접 실행하면서 비교해보았습니다.</p>\n<aside>\r\n📚 이 포스트는 [RxJS](https://rxjs.dev/)와 [JavaScript의 Promise](https://developer.mozilla.org/ko/docs/Web/JavaScript/Reference/Global_Objects/Promise)에 대한 기본적인 지식이 있다면, 쉽게 이해할 수 있습니다.\n</aside>\n<p>실험 내용은 reject되는 Promise를 defer() 함수와 from() 함수를 이용하여 Observable로 변환한 후, retry 연산자로 reject된 Promise를 어떻게 처리하는지 실험하였습니다.</p>\n<aside>\r\n📝 실험에 앞서, RxJS의 from(), defer(),  retry()에 관해 간단하게 알아보겠습니다.\n<ul>\n<li>from(): 옵저버블로 변환할 수 있을 만한 객체들을 옵저버블로 변환해줍니다.</li>\n<li>defer(): 구독하는 시점에 팩토리 함수를 호출해 생성한 옵저버블을 구독합니다.</li>\n<li>retry(): 에러가 발생했을 때 인자로 설정한 정숫값만큼 소스 옵저버블 구독을 재시도하는 연산자입니다.</li>\n</ul>\n</aside>\n<p>먼저 defer()로 생성된 Observable를 확인해보도록 하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> retry<span class=\"token punctuation\">,</span> defer<span class=\"token punctuation\">,</span> catchError <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'rxjs'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token function\">defer</span><span class=\"token punctuation\">(</span>\r\n  <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\r\n    <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve<span class=\"token punctuation\">,</span> reject</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Promise created!!'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Promise rejected!'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token function\">reject</span><span class=\"token punctuation\">(</span><span class=\"token string\">'reject'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\r\n<span class=\"token punctuation\">)</span>\r\n  <span class=\"token punctuation\">.</span><span class=\"token function\">pipe</span><span class=\"token punctuation\">(</span>\r\n    <span class=\"token function\">catchError</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>error<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> 발생</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token keyword\">throw</span> error<span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token function\">retry</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token punctuation\">)</span>\r\n  <span class=\"token punctuation\">.</span><span class=\"token function\">subscribe</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n    <span class=\"token function-variable function\">next</span><span class=\"token operator\">:</span> <span class=\"token parameter\">value</span> <span class=\"token operator\">=></span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">defer next: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>value<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token function-variable function\">error</span><span class=\"token operator\">:</span> <span class=\"token parameter\">error</span> <span class=\"token operator\">=></span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">defer error: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>error<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token function-variable function\">complete</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'defer complete'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>해당 소스 코드를 실행해보면</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">Promise created<span class=\"token operator\">!</span><span class=\"token operator\">!</span>\r\nPromise rejected<span class=\"token operator\">!</span>\r\nreject 발생\r\nPromise created<span class=\"token operator\">!</span><span class=\"token operator\">!</span>\r\nPromise rejected<span class=\"token operator\">!</span>\r\nreject 발생\r\nPromise created<span class=\"token operator\">!</span><span class=\"token operator\">!</span>\r\nPromise rejected<span class=\"token operator\">!</span>\r\nreject 발생\r\ndefer error: reject</code></pre></div>\n<p>Promise가 reject되면, retry 연산자는 다시 구독을 하면서 새로운 Promise를 생성하여 동작하는 것을 알 수 있습니다.</p>\n<p>이제 from()으로 생성된 Observable이 어떻게 동작하는지 확인해보겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> retry<span class=\"token punctuation\">,</span> from<span class=\"token punctuation\">,</span> catchError <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'rxjs'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token function\">from</span><span class=\"token punctuation\">(</span>\r\n  <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve<span class=\"token punctuation\">,</span> reject</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Promise created!!'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Promise rejected!'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">reject</span><span class=\"token punctuation\">(</span><span class=\"token string\">'reject'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\r\n<span class=\"token punctuation\">)</span>\r\n  <span class=\"token punctuation\">.</span><span class=\"token function\">pipe</span><span class=\"token punctuation\">(</span>\r\n    <span class=\"token function\">catchError</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>error<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> 발생</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token keyword\">throw</span> error<span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token function\">retry</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token punctuation\">)</span>\r\n  <span class=\"token punctuation\">.</span><span class=\"token function\">subscribe</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n    <span class=\"token function-variable function\">next</span><span class=\"token operator\">:</span> <span class=\"token parameter\">value</span> <span class=\"token operator\">=></span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">defer next: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>value<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token function-variable function\">error</span><span class=\"token operator\">:</span> <span class=\"token parameter\">error</span> <span class=\"token operator\">=></span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">defer error: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>error<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token function-variable function\">complete</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'defer complete'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>해당 소스 코드를 실행해보면</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">Promise created<span class=\"token operator\">!</span><span class=\"token operator\">!</span>\r\nPromise rejected<span class=\"token operator\">!</span>\r\nreject 발생\r\nreject 발생\r\nreject 발생\r\ndefer error: reject</code></pre></div>\n<p>from()으로 생성된 Promise Observable은 reject로 인해 에러가 발생하면 retry 연산자를 사용하여 재구독합니다. 그러나 defer() 함수와 달리 새로운 Promise를 생성하는 것이 아니라 이미 실행이 완료된(rejected) Promise를 그대로 재구독하는 것을 알 수 있습니다.</p>\n<p>위 실험 결과, 에러가 발생했을 때 retry 연산자를 통해 defer() 함수는 매번 새로운 Promise를 생성하여 구독하고, from() 함수는 이미 완료된 Promise를 그대로 재구독하는 것을 알 수 있습니다.</p>\n<p>이러한 특성 때문에, from() 함수는 이미 실행 중이거나 완료한 프로미스를 옵저버블로 만들 때 적합하고 defer() 함수는 프로미스 실행 시점이 구독하는 시점이어야 할 때 적합하고 상황에 따라 defer()함수와 from() 함수 중 적절한 생성 함수를 사용해야합니다.</p>","frontmatter":{"title":"RxJS의 from()과 defer()","summary":"RxJS의 from()과 defer()","date":"2022.09.13.","categories":["RxJS"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABiUlEQVQY011RTSiEURS9n/jMCGOMwTTDGJGaO6apYcFqFjaztLBQNlbqPRQbC5bEd997MxOarfyllKSsJD8plCxkwQLFRgoLCwubp2/GFBan0+3ezjn3XthqksZGSMCXJx248KuNA79aOq+WicMaAcozDZkgAUMb1g+TwfMMBbYx0i6BRwhAFy+AhkVHtkVcrjVLfeZV+rFC6RuXnNcladCQBY6WydBysr9Cxk9dypCc6737MBwRAMtBgt2ASGRDQi+0ytUtn2h7K1Pje14xk4jNRpKxOdu5gyH1cKQ6huThSGUMyeRITQxzPSwYwHG9hBOfjF+5pX4oV123LgU7PgH9MatvCK3RkbBlC8Y5UjdH8jCkJEMKMKQGjhTiSEGG1MWRHHZyuHZJ48Yt4c2d2nypTJ2+mwqP6lV3tkXeTYapcypMMIbCyZGKeH69SobkYPl0JkOqZUj+ZOtg7hTw4U0bX74MPEUz5mtNauW1IvV5XSXvtxvVxLNTgAYBA1GRG/79hP9PKfS/ATPOqcdLYY5sAAAAAElFTkSuQmCC"},"images":{"fallback":{"src":"/static/e85553cfdb8db819c496c7d6ae9dad2b/33adc/rxjs_logo.png","srcSet":"/static/e85553cfdb8db819c496c7d6ae9dad2b/29183/rxjs_logo.png 400w,\n/static/e85553cfdb8db819c496c7d6ae9dad2b/d8bab/rxjs_logo.png 800w,\n/static/e85553cfdb8db819c496c7d6ae9dad2b/33adc/rxjs_logo.png 1600w","sizes":"(min-width: 1600px) 1600px, 100vw"},"sources":[{"srcSet":"/static/e85553cfdb8db819c496c7d6ae9dad2b/91b29/rxjs_logo.webp 400w,\n/static/e85553cfdb8db819c496c7d6ae9dad2b/3864f/rxjs_logo.webp 800w,\n/static/e85553cfdb8db819c496c7d6ae9dad2b/e6edc/rxjs_logo.webp 1600w","type":"image/webp","sizes":"(min-width: 1600px) 1600px, 100vw"}]},"width":1600,"height":479}},"publicURL":"/static/e85553cfdb8db819c496c7d6ae9dad2b/rxjs_logo.png"}}}}]}},"pageContext":{"slug":"/RxJS/from_and_defer/"}},
    "staticQueryHashes": []}